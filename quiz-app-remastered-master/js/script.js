const STORE = {
 questions: {
  Freedom: [
    {
        question: "A school principal denies a student admission based on their caste. Which right is being violated?",
        answers: [
          "Right to Education",
          "Right to Equality",
          "Right to Freedom of Speech",
          "Right to Privacy"
        ],
        correctAnswer: "Right to Equality"
      },
      {
        question: "A journalist is arrested for publishing an article criticizing the government. Which right is being violated?",
        answers: [
          "Right to Freedom of Religion",
          "Right to Equality",
          "Right to Freedom of Speech",
          "Right to Education"
        ],
        correctAnswer: "Right to Freedom of Speech"
      },
      {
        question: "A child from a rural area is unable to attend school due to lack of transportation. What right is most relevant in this scenario?",
        answers: [
          "Right to Freedom",
          "Right to Equality",
          "Right to Education",
          "Right to Privacy"
        ],
        correctAnswer: "Right to Education"
      },
      {
        question: "An employee is being harassed at work but fears retaliation if they report it. Which right should protect them?",
        answers: [
          "Right to Equality",
          "Right to Freedom from Abuse",
          "Right to Education",
          "Right to Freedom of Assembly"
        ],
        correctAnswer: "Right to Freedom from Abuse"
      },
      {
        question: "A person is arrested for possession of a small amount of a recreational drug. Which right may be questioned in this context?",
        answers: [
          "Right to Privacy",
          "Right to Freedom",
          "Right to Equality",
          "Right to Education"
        ],
        correctAnswer: "Right to Freedom"
      },
      {
        question: "During a traffic stop, a police officer targets a driver based solely on their ethnicity. What right is being violated?",
        answers: [
          "Right to Education",
          "Right to Equality",
          "Right to Freedom of Movement",
          "Right to Freedom from Abuse"
        ],
        correctAnswer: "Right to Equality"
      },
      {
        question: "A teenager is not allowed to attend a drug rehabilitation program due to their background. Which right is being violated?",
        answers: [
          "Right to Education",
          "Right to Freedom",
          "Right to Equality",
          "Right to Privacy"
        ],
        correctAnswer: "Right to Equality"
      },
      {
        question: "A school implements a policy that restricts students from expressing their opinions during class. Which right does this affect?",
        answers: [
          "Right to Education",
          "Right to Freedom of Speech",
          "Right to Equality",
          "Right to Freedom of Religion"
        ],
        correctAnswer: "Right to Freedom of Speech"
      }
  ],
  speech: [

        {
            question: "An individual is denied access to public services because of their drug addiction. Which right could be argued as being violated?",
            answers: [
              "Right to Freedom",
              "Right to Equality",
              "Right to Education",
              "Right to Privacy"
            ],
            correctAnswer: "Right to Equality"
          },
          {
            question: "A woman faces discrimination in hiring because of her gender. Which right does this scenario highlight?",
            answers: [
              "Right to Education",
              "Right to Freedom",
              "Right to Equality",
              "Right to Privacy"
            ],
            correctAnswer: "Right to Equality"
          },
          {
            question: "A child is bullied at school for their academic performance, leading to their withdrawal from education. Which right is being violated?",
            answers: [
              "Right to Freedom",
              "Right to Equality",
              "Right to Education",
              "Right to Freedom from Abuse"
            ],
            correctAnswer: "Right to Education"
          },
          {
            question: "An individual wants to express their opinion about drug policies but is silenced by threats. Which right is at stake?",
            answers: [
              "Right to Freedom of Speech",
              "Right to Education",
              "Right to Equality",
              "Right to Privacy"
            ],
            correctAnswer: "Right to Freedom of Speech"
          },
          {
            question: "In a traffic accident, one party is unfairly blamed due to their race. What right is being violated?",
            answers: [
              "Right to Freedom",
              "Right to Education",
              "Right to Equality",
              "Right to Privacy"
            ],
            correctAnswer: "Right to Equality"
          },
          {
            question: "A student is not allowed to join extracurricular activities due to their background. Which right is being violated?",
            answers: [
              "Right to Freedom of Speech",
              "Right to Education",
              "Right to Equality",
              "Right to Privacy"
            ],
            correctAnswer: "Right to Equality"
          },
          {
            question: "An employee reports drug abuse in the workplace but fears losing their job. Which right protects their actions?",
            answers: [
              "Right to Freedom from Abuse",
              "Right to Education",
              "Right to Equality",
              "Right to Freedom of Speech"
            ],
            correctAnswer: "Right to Freedom from Abuse"
          }
  ],
  laws: [
        {
            question: "A school principal denies a student admission based on their caste. Which right is being violated?",
            answers: [
              "Right to Education",
              "Right to Equality",
              "Right to Freedom of Speech",
              "Right to Privacy"
            ],
            correctAnswer: "Right to Equality"
          },
          {
            question: "A journalist is arrested for publishing an article criticizing the government. Which right is being violated?",
            answers: [
              "Right to Freedom of Religion",
              "Right to Equality",
              "Right to Freedom of Speech",
              "Right to Education"
            ],
            correctAnswer: "Right to Freedom of Speech"
          },
          {
            question: "A child from a rural area is unable to attend school due to lack of transportation. What right is most relevant in this scenario?",
            answers: [
              "Right to Freedom",
              "Right to Equality",
              "Right to Education",
              "Right to Privacy"
            ],
            correctAnswer: "Right to Education"
          },
          {
            question: "An employee is being harassed at work but fears retaliation if they report it. Which right should protect them?",
            answers: [
              "Right to Equality",
              "Right to Freedom from Abuse",
              "Right to Education",
              "Right to Freedom of Assembly"
            ],
            correctAnswer: "Right to Freedom from Abuse"
          },
          {
            question: "A person is arrested for possession of a small amount of a recreational drug. Which right may be questioned in this context?",
            answers: [
              "Right to Privacy",
              "Right to Freedom",
              "Right to Equality",
              "Right to Education"
            ],
            correctAnswer: "Right to Freedom"
          },
          {
            question: "During a traffic stop, a police officer targets a driver based solely on their ethnicity. What right is being violated?",
            answers: [
              "Right to Education",
              "Right to Equality",
              "Right to Freedom of Movement",
              "Right to Freedom from Abuse"
            ],
            correctAnswer: "Right to Equality"
          },
          {
            question: "A teenager is not allowed to attend a drug rehabilitation program due to their background. Which right is being violated?",
            answers: [
              "Right to Education",
              "Right to Freedom",
              "Right to Equality",
              "Right to Privacy"
            ],
            correctAnswer: "Right to Equality"
          }
  ],
  articals: [
    {
        question: "A school implements a policy that restricts students from expressing their opinions during class. Which right does this affect?",
        answers: [
          "Right to Education",
          "Right to Freedom of Speech",
          "Right to Equality",
          "Right to Freedom of Religion"
        ],
        correctAnswer: "Right to Freedom of Speech"
      },
      {
        question: "An individual is denied access to public services because of their drug addiction. Which right could be argued as being violated?",
        answers: [
          "Right to Freedom",
          "Right to Equality",
          "Right to Education",
          "Right to Privacy"
        ],
        correctAnswer: "Right to Equality"
      },
      {
        question: "A woman faces discrimination in hiring because of her gender. Which right does this scenario highlight?",
        answers: [
          "Right to Education",
          "Right to Freedom",
          "Right to Equality",
          "Right to Privacy"
        ],
        correctAnswer: "Right to Equality"
      },
      {
        question: "A child is bullied at school for their academic performance, leading to their withdrawal from education. Which right is being violated?",
        answers: [
          "Right to Freedom",
          "Right to Equality",
          "Right to Education",
          "Right to Freedom from Abuse"
        ],
        correctAnswer: "Right to Education"
      },
      {
        question: "An individual wants to express their opinion about drug policies but is silenced by threats. Which right is at stake?",
        answers: [
          "Right to Freedom of Speech",
          "Right to Education",
          "Right to Equality",
          "Right to Privacy"
        ],
        correctAnswer: "Right to Freedom of Speech"
      },
      {
        question: "In a traffic accident, one party is unfairly blamed due to their race. What right is being violated?",
        answers: [
          "Right to Freedom",
          "Right to Education",
          "Right to Equality",
          "Right to Privacy"
        ],
        correctAnswer: "Right to Equality"
      },
      {
        question: "A student is not allowed to join extracurricular activities due to their background. Which right is being violated?",
        answers: [
          "Right to Freedom of Speech",
          "Right to Education",
          "Right to Equality",
          "Right to Privacy"
        ],
        correctAnswer: "Right to Equality"
      },
      {
        question: "An employee reports drug abuse in the workplace but fears losing their job. Which right protects their actions?",
        answers: [
          "Right to Freedom from Abuse",
          "Right to Education",
          "Right to Equality",
          "Right to Freedom of Speech"
        ],
        correctAnswer: "Right to Freedom from Abuse"
      },
      {
        question: "A woman is forced to quit her job after reporting harassment. Which right has been violated?",
        answers: [
          "Right to Freedom from Abuse",
          "Right to Education",
          "Right to Equality",
          "Right to Privacy"
        ],
        correctAnswer: "Right to Freedom from Abuse"
      },
      {
        question: "A teenager is bullied for not participating in drug use. Which right is relevant here?",
        answers: [
          "Right to Equality",
          "Right to Freedom from Abuse",
          "Right to Education",
          "Right to Freedom of Speech"
        ],
        correctAnswer: "Right to Equality"
      },
      {
        question: "A group of students is not allowed to form a club based on their sexual orientation. Which right is being violated?",
        answers: [
          "Right to Freedom of Assembly",
          "Right to Equality",
          "Right to Freedom of Speech",
          "Right to Privacy"
        ],
        correctAnswer: "Right to Freedom of Assembly"
      }
  ],
  traffic: [
    {
        question: "A traffic officer stops a person for not wearing a seatbelt but ignores another person based on their appearance. What right is at stake?",
        answers: [
          "Right to Equality",
          "Right to Education",
          "Right to Freedom of Movement",
          "Right to Privacy"
        ],
        correctAnswer: "Right to Equality"
      },
      {
        question: "A child from a poor family is unable to afford school fees. Which right is most relevant in this scenario?",
        answers: [
          "Right to Freedom",
          "Right to Equality",
          "Right to Education",
          "Right to Privacy"
        ],
        correctAnswer: "Right to Education"
      },
      {
        question: "A person is denied bail due to their criminal record, while others with similar records are granted bail. Which right is violated?",
        answers: [
          "Right to Freedom",
          "Right to Equality",
          "Right to Education",
          "Right to Privacy"
        ],
        correctAnswer: "Right to Equality"
      },
      {
        question: "A person is stopped by police for no apparent reason, solely based on their ethnicity. What right is at stake?",
        answers: [
          "Right to Freedom from Abuse",
          "Right to Education",
          "Right to Equality",
          "Right to Privacy"
        ],
        correctAnswer: "Right to Equality"
      },
      {
        question: "A young woman is told she cannot pursue a certain career due to her gender. Which right is being violated?",
        answers: [
          "Right to Freedom",
          "Right to Education",
          "Right to Equality",
          "Right to Privacy"
        ],
        correctAnswer: "Right to Equality"
      },
      {
        question: "A child is forced to work instead of going to school. Which right is being violated?",
        answers: [
          "Right to Freedom",
          "Right to Education",
          "Right to Equality",
          "Right to Freedom from Abuse"
        ],
        correctAnswer: "Right to Education"
      },
      {
        question: "A person is not allowed to speak during a public forum about their experience with drugs. Which right is affected?",
        answers: [
          "Right to Freedom of Speech",
          "Right to Education",
          "Right to Equality",
          "Right to Privacy"
        ],
        correctAnswer: "Right to Freedom of Speech"
      },
      {
        question: "A school principal favors certain students for scholarships based on personal bias. Which right is being violated?",
        answers: [
          "Right to Freedom",
          "Right to Education",
          "Right to Equality",
          "Right to Privacy"
        ],
        correctAnswer: "Right to Equality"
      },
      {
        question: "A parent is denied custody of their child due to their social status. Which right does this violate?",
        answers: [
          "Right to Education",
          "Right to Equality",
          "Right to Freedom",
          "Right to Privacy"
        ],
        correctAnswer: "Right to Equality"
      },
      {
        question: "A person is forced into drug trafficking due to financial issues. Which right is compromised?",
        answers: [
          "Right to Freedom",
          "Right to Education",
          "Right to Equality",
          "Right to Freedom from Abuse"
        ],
        correctAnswer: "Right to Freedom"
      }
  ],
  drugs: [
    {
        question: "A student is expelled from school for speaking out against bullying. Which right is being violated?",
        answers: [
          "Right to Education",
          "Right to Freedom of Speech",
          "Right to Equality",
          "Right to Privacy"
        ],
        correctAnswer: "Right to Freedom of Speech"
      },
      {
        question: "A job applicant is overlooked due to their age, despite being qualified. What right is being violated?",
        answers: [
          "Right to Education",
          "Right to Equality",
          "Right to Freedom",
          "Right to Privacy"
        ],
        correctAnswer: "Right to Equality"
      },
      {
        question: "A teenager is refused entry to a community center because of their clothing style. Which right is relevant?",
        answers: [
          "Right to Education",
          "Right to Freedom of Expression",
          "Right to Equality",
          "Right to Privacy"
        ],
        correctAnswer: "Right to Freedom of Expression"
      },
      {
        question: "A drug user is denied access to healthcare services. Which right is being compromised?",
        answers: [
          "Right to Freedom",
          "Right to Equality",
          "Right to Education",
          "Right to Privacy"
        ],
        correctAnswer: "Right to Equality"
      },
      {
        question: "An individual is not allowed to join a public meeting because of their political beliefs. What right is at stake?",
        answers: [
          "Right to Freedom of Assembly",
          "Right to Education",
          "Right to Equality",
          "Right to Privacy"
        ],
        correctAnswer: "Right to Freedom of Assembly"
      },
      {
        question: "A school refuses to teach about LGBTQ+ issues, leading to misinformation among students. Which right does this affect?",
        answers: [
          "Right to Education",
          "Right to Freedom of Speech",
          "Right to Equality",
          "Right to Freedom of Expression"
        ],
        correctAnswer: "Right to Education"
      },
      {
        question: "A person is stopped and searched by police without reasonable cause. What right is being violated?",
        answers: [
          "Right to Freedom",
          "Right to Equality",
          "Right to Privacy",
          "Right to Education"
        ],
        correctAnswer: "Right to Privacy"
      },
      {
        question: "A child is bullied at school for their appearance, leading to mental health issues. Which right is being compromised?",
        answers: [
          "Right to Education",
          "Right to Freedom from Abuse",
          "Right to Equality",
          "Right to Freedom of Expression"
        ],
        correctAnswer: "Right to Freedom from Abuse"
      },
      {
        question: "An employee is forced to resign after reporting workplace harassment. What right is being violated?",
        answers: [
          "Right to Freedom from Abuse",
          "Right to Education",
          "Right to Equality",
          "Right to Privacy"
        ],
        correctAnswer: "Right to Freedom from Abuse"
      }
  ],
  abuse: [
    {
        question: "A police officer gives a ticket to a driver based on their skin color rather than traffic violation. Which right is at stake?",
        answers: [
          "Right to Education",
          "Right to Equality",
          "Right to Freedom of Movement",
          "Right to Privacy"
        ],
        correctAnswer: "Right to Equality"
      },
      {
        question: "A student is not allowed to speak in class about their views on drug legalization. Which right is affected?",
        answers: [
          "Right to Freedom of Speech",
          "Right to Education",
          "Right to Equality",
          "Right to Privacy"
        ],
        correctAnswer: "Right to Freedom of Speech"
      },
      {
        question: "An individual is denied a loan because of their socio-economic background. Which right does this violate?",
        answers: [
          "Right to Equality",
          "Right to Freedom",
          "Right to Education",
          "Right to Privacy"
        ],
        correctAnswer: "Right to Equality"
      },
      {
        question: "A woman is denied a promotion because she is pregnant. Which right is being violated?",
        answers: [
          "Right to Equality",
          "Right to Education",
          "Right to Freedom",
          "Right to Privacy"
        ],
        correctAnswer: "Right to Equality"
      },
      {
        question: "A community is blocked from accessing a public park based on their neighborhood. What right is being violated?",
        answers: [
          "Right to Freedom of Movement",
          "Right to Education",
          "Right to Equality",
          "Right to Privacy"
        ],
        correctAnswer: "Right to Equality"
      },
      {
        question: "A student faces expulsion for discussing drug use openly in a school setting. Which right is relevant here?",
        answers: [
          "Right to Freedom of Speech",
          "Right to Education",
          "Right to Equality",
          "Right to Privacy"
        ],
        correctAnswer: "Right to Freedom of Speech"
      },
      {
        question: "An individual is mocked for their learning disability, preventing them from participating in class. Which right is violated?",
        answers: [
          "Right to Freedom",
          "Right to Education",
          "Right to Equality",
          "Right to Freedom from Abuse"
        ],
        correctAnswer: "Right to Equality"
      },
      {
        question: "A minor is not allowed to attend drug prevention programs due to age restrictions. What right is at stake?",
        answers: [
          "Right to Education",
          "Right to Freedom",
          "Right to Equality",
          "Right to Privacy"
        ],
        correctAnswer: "Right to Education"
      },
      {
        question: "A group is protesting for their rights but is denied the permit to gather. Which right is being violated?",
        answers: [
          "Right to Freedom of Assembly",
          "Right to Education",
          "Right to Equality",
          "Right to Privacy"
        ],
        correctAnswer: "Right to Freedom of Assembly"
      }
  ],
  exploitation: [
    {
        question: "A person is subjected to discrimination at work based on their religion. Which right is being violated?",
        answers: [
          "Right to Freedom from Abuse",
          "Right to Education",
          "Right to Equality",
          "Right to Privacy"
        ],
        correctAnswer: "Right to Equality"
      },
      {
        question: "A child is not allowed to attend school because they do not speak the local language. What right is relevant here?",
        answers: [
          "Right to Education",
          "Right to Freedom of Speech",
          "Right to Equality",
          "Right to Privacy"
        ],
        correctAnswer: "Right to Education"
      },
      {
        question: "A person is arrested for advocating against drug policies. Which right is affected?",
        answers: [
          "Right to Freedom of Speech",
          "Right to Education",
          "Right to Equality",
          "Right to Privacy"
        ],
        correctAnswer: "Right to Freedom of Speech"
      },
      {
        question: "A teenager is pressured into drug use by peers, affecting their academic performance. Which right is at risk?",
        answers: [
          "Right to Education",
          "Right to Freedom from Abuse",
          "Right to Equality",
          "Right to Freedom"
        ],
        correctAnswer: "Right to Freedom from Abuse"
      },
      {
        question: "A traffic violator is let go without a ticket because of their connections. Which right is being violated?",
        answers: [
          "Right to Equality",
          "Right to Education",
          "Right to Freedom of Movement",
          "Right to Privacy"
        ],
        correctAnswer: "Right to Equality"
      },
      {
        question: "A woman is told she cannot pursue a particular field of study because it is 'not meant for her.' Which right does this violate?",
        answers: [
          "Right to Education",
          "Right to Equality",
          "Right to Freedom",
          "Right to Privacy"
        ],
        correctAnswer: "Right to Equality"
      },
      {
        question: "A person is discriminated against for their disability when trying to access public transport. Which right is being violated?",
        answers: [
          "Right to Education",
          "Right to Freedom",
          "Right to Equality",
          "Right to Privacy"
        ],
        correctAnswer: "Right to Equality"
      }
  ],
  equality: [
    {
        question: "A student is denied access to a school because of their ethnic background. Which right is violated?",
        answers: [
          "Right to Education",
          "Right to Freedom of Movement",
          "Right to Equality",
          "Right to Privacy"
        ],
        correctAnswer: "Right to Equality"
      },
      {
        question: "A person is treated differently by law enforcement based on their gender identity. What right is affected?",
        answers: [
          "Right to Equality",
          "Right to Freedom of Expression",
          "Right to Education",
          "Right to Privacy"
        ],
        correctAnswer: "Right to Equality"
      },
      {
        question: "An employee is fired for reporting harassment in the workplace. Which right is being violated?",
        answers: [
          "Right to Freedom from Abuse",
          "Right to Education",
          "Right to Equality",
          "Right to Privacy"
        ],
        correctAnswer: "Right to Freedom from Abuse"
      },
      {
        question: "A child is bullied for their physical appearance, leading to depression. Which right does this violate?",
        answers: [
          "Right to Education",
          "Right to Freedom from Abuse",
          "Right to Equality",
          "Right to Freedom of Expression"
        ],
        correctAnswer: "Right to Freedom from Abuse"
      },
      {
        question: "A person is arrested for peacefully protesting against government policies. Which right is at stake?",
        answers: [
          "Right to Freedom of Assembly",
          "Right to Education",
          "Right to Equality",
          "Right to Privacy"
        ],
        correctAnswer: "Right to Freedom of Assembly"
      },
      {
        question: "A student is given lower grades due to their family's economic status. Which right is being violated?",
        answers: [
          "Right to Education",
          "Right to Equality",
          "Right to Freedom",
          "Right to Privacy"
        ],
        correctAnswer: "Right to Equality"
      },
      {
        question: "An individual is denied a public service because of their political views. What right is affected?",
        answers: [
          "Right to Freedom of Expression",
          "Right to Education",
          "Right to Equality",
          "Right to Privacy"
        ],
        correctAnswer: "Right to Freedom of Expression"
      }
  ],
  education: [
    {
        question: "A young person is not allowed to participate in a drug awareness program because they are under 18. Which right is relevant?",
        answers: [
          "Right to Education",
          "Right to Freedom",
          "Right to Equality",
          "Right to Privacy"
        ],
        correctAnswer: "Right to Education"
      },
      {
        question: "A person is stopped for a traffic violation and treated harshly due to their ethnicity. Which right is being violated?",
        answers: [
          "Right to Education",
          "Right to Equality",
          "Right to Freedom of Movement",
          "Right to Privacy"
        ],
        correctAnswer: "Right to Equality"
      },
      {
        question: "A student is not allowed to join a club because of their gender. Which right is violated?",
        answers: [
          "Right to Education",
          "Right to Freedom of Expression",
          "Right to Equality",
          "Right to Privacy"
        ],
        correctAnswer: "Right to Equality"
      },
      {
        question: "A victim of domestic violence is told by authorities that it's a private matter and no action will be taken. What right is at stake?",
        answers: [
          "Right to Freedom from Abuse",
          "Right to Education",
          "Right to Equality",
          "Right to Privacy"
        ],
        correctAnswer: "Right to Freedom from Abuse"
      },
      {
        question: "A teacher refuses to teach a student with disabilities. Which right is being violated?",
        answers: [
          "Right to Freedom from Abuse",
          "Right to Education",
          "Right to Equality",
          "Right to Privacy"
        ],
        correctAnswer: "Right to Education"
      },
      {
        question: "A woman is charged with a higher penalty than a man for the same traffic violation. Which right does this violate?",
        answers: [
          "Right to Freedom",
          "Right to Equality",
          "Right to Education",
          "Right to Privacy"
        ],
        correctAnswer: "Right to Equality"
      },
      {
        question: "A parent is not allowed to enroll their child in school due to lack of funds. Which right is compromised?",
        answers: [
          "Right to Education",
          "Right to Freedom",
          "Right to Equality",
          "Right to Privacy"
        ],
        correctAnswer: "Right to Education"
      }
  ]
 }
};

// Make the quiz. Create a model for our app's state
function makeQuiz(){
	// Creating an object to store the app's state when beginning the quiz
	return {
		// Gathering a random question out of the available questions for each category
		questions: helpers.getRandomQuestions(STORE),
		// Boolean for if the quiz is in progress or not
		midQuiz: false,
		// Array of correct/incorrect answers to use for our progress bar
		progress: {
			progressBar: [],
			incorrectCategories: []
		},
		// Boolean to determine if the end state should display
		completed: false,
		// Monitoring which question we are currently on
		currentQuestion: 0,
		// Keeps track of total correct answers
		correctAnswers: 0,
		// Keeps current selected answer
		currentAnswer: "",
		// Keeps track of % completed
		percCorrect: 0
	}
}

// Apply fadeOut animations and set the stage for DOM text/element changes
function $fade(appState){

	// This is the completed state of of a quiz
	if(appState.completed){
		
		// Fade out elements with a promise to avoid choppy behavior
		$.when($('.question-answer-wrapper, .question-wrapper, .answer-wrapper').fadeOut(500))
			.done(function(){

				// Display results of the quiz
				$showResults(appState);
				$('.results-wrapper').hide().removeClass('hide');
				$('.question-answer-wrapper, .results-wrapper').fadeIn(500);
	    });

	// This is if the app is just starting
	} else if(appState.midQuiz === false){

		// Set a flag that the app has begun
		appState.midQuiz = true;
		// Fade out elements with a promise to avoid choppy behavior
		$.when($('.question-answer-wrapper, .question-wrapper, .code, .answer-wrapper, .start-quiz, .quit-quiz, .results-wrapper, .progress, .progress-bar').fadeOut(500))
			.done(function(){
				// Remove any progress from a previous quiz (if any);
				helpers.updateProgressBar(appState);
				$('.progress-count').html('1 / 10');
				$('.progress-perc').html('');
				// Kill previous results
				$('.failures').remove();
				// Lots to do... mostly just setting up a new environment for a new quiz
				$updateQuestion(appState);
				$('progress-bar').empty();
				$('progress-fill').html('Progress: <span class="progress-count">1 / 10</span><span class="progress-perc"></span>');
				$('.question-answer-wrapper, .answer-wrapper').removeClass('begin');
				$('.submit-btn, .progress, .progress-bar').removeClass('hide');
				$('.progress, .progress-bar').hide();
				$('.question-answer-wrapper, .question-wrapper, .answer-wrapper, .progress, .progress-bar').fadeIn(500);
				if(!$('.code').hasClass('hide')){$('.code').fadeIn(500)};
	    });

	// This is if the app is in the middle of execution
	} else if(appState.midQuiz){
		$.when($('.question-answer-wrapper, .question-wrapper, .answer-wrapper').fadeOut(500))
			.done(function(){
				$updateQuestion(appState);
				$('.question-answer-wrapper, .question-wrapper, .answer-wrapper').fadeIn(500);
	    });
	}
}

// Work in progress...
function $showResults(appState){
	if(appState.correctAnswers === 10){
		let endMsg = `You got ${appState.percCorrect}% correct!
I have nothing else to teach you. Move on and prosper!
`;
	} else {
		$('.answer-btn').remove();
		let endMsg = `You got ${appState.percCorrect}% correct!`
		let endFeedback = ``;
		if(appState.progress.incorrectCategories.length === 0){
			endFeedback = `You aced it! Good job!`;
		} else {
			endFeedback = `You may want to study up on the following categories:`;
		}
		
		$('.quiz-end-score').html(endMsg);
		let $failList = $('<ul class="failures"></ul>');
		appState.progress.incorrectCategories.map((cat => {
			$failList.append("<li class='category'>" + cat + "</li>");
		}));
	
		$('.results-wrapper').removeClass('hide').css('display', 'flex');
		$('.question-answer-wrapper, .results-wrapper, .quiz-end-feedback, .quiz-end-score, .retry-btn').css('display', 'flex').fadeIn(500);		
	}

}

// Update the question, code, answers, buttons in the DOM while we're in a faded out state
function $updateQuestion(appState){
	$('.answer-btn').remove();

	// Update the question and code text with the current question
	$('.question').html(appState.questions[appState.currentQuestion].question);

	// This is a hack to hide/show the code portion
	// Only 1/3 of the questions contain code so we hide it if they aren't present
	if(appState.questions[appState.currentQuestion].code == ``){
		$('.code').addClass('hide');
	} else {
		$('.code').removeClass('hide');
		
	}
	
	// Change continue back to submit
	$('.continue-btn')
		.val("Submit")
		.removeClass('continue-btn')
		.addClass('submit-btn')
		.prop('disabled', true);

	// Add in available answers for the question
	let $answers = [];

	// Adding the answers to a temporary array
	for(let i=0; i<appState.questions[appState.currentQuestion].answers.length; i++){

		// Add current question answers to an array
		let $answer = $('<button class="answer-btn" type="button"></button>');
		$answer.html(appState.questions[appState.currentQuestion].answers[i]);
		$answers.push($answer);
	}

	// Shuffle the answers
	helpers.shuffleAnswers($answers)

	// Push answers to the DOM
	$answers.forEach((answer) => {
		$('.answer-wrapper').prepend(answer);
	});
}

// Simple class and enable/disable DOM selection when answer is selected
function selectAnswer(answer){
	$('.answer-btn').removeClass('selected');
	answer.addClass('selected');
	$('.submit-btn').prop('disabled', false);
}

// Answer is selected and submitted
// Push a feedback state
function submitAnswer(appState){

	// This will be returned true or false based on their answer
	let correct;

	// Add styles to the answers to show if their answer was correct or not
	$('.answer-btn').each(function () {
		if($(this).html() === appState.questions[appState.currentQuestion].correctAnswer){
			$(this).addClass('pass');
			// If answer is correct and selected...
			if($(this).hasClass('selected')){
				correct = "pass";
				appState.correctAnswers++;
				appState.questions[appState.currentQuestion];
			}

		// Handle correct answer if selected answer is incorrect
		} else if ($(this).hasClass('selected')){
			$(this).addClass('fail dim-answer');
			correct = "fail";
			appState.progress.incorrectCategories.push(appState.questions[appState.currentQuestion].category);

		// Dim the other answers to make the correct one more prevalent
		} else {
			$(this).addClass('dim-answer');
		}
	});

	// Add a progress bar indicator to our appState object
	appState.progress.progressBar.push(`<div class="progress-indicator ${correct}"></div>`);
	
	// Update our percent correct (parse a float and set it to a fixed percentage)
	appState.percCorrect = parseFloat(appState.correctAnswers / (appState.currentQuestion + 1) * 100).toFixed();

	// Update our current question VS total quiz length
	$('.progress-count').html(`
		${appState.currentQuestion + 1} / ${appState.questions.length}
	`);

	// Update our current correct percentage
	$('.progress-perc').html(`
		 // ${(appState.percCorrect)}% Correct
	`)

	// Change submit back to continue
	$('.submit-btn')
		.val("Continue")
		.removeClass('submit-btn')
		.addClass('continue-btn')

	// Disable selecting answers
	$('.answer-btn').prop("disabled", true);

	// Update our progress-bar DOM
	helpers.updateProgressBar(appState);

	// Continue to next question
	appState.currentQuestion++;

	// Verify if we're done or not
	if(appState.currentQuestion === appState.questions.length){
		appState.completed = true;
	}
	
}

// Silly easter egg for saying you don't want to do the quiz

function killQuiz() {
  $('.start-quiz, .quit-quiz').hide();
  let failureMsg = "You have chosen to quit the game.";
  let msgSplit = failureMsg.split(" ");
  let counter = 0;
  $('.question').empty();
  
  let startTroll = setInterval(function () {
      $('.question').append(msgSplit[counter] + " ");
      counter++;
      if (counter > msgSplit.length - 1) {
          clearInterval(startTroll);
          // Optionally, add a delay before quitting
          setTimeout(quitPage, 1000); // 1 second delay before quitting
      }
  }, 250);
}

function quitPage() {
  // Create a throw-out effect
  $('body').animate({ opacity: 0 }, 500, function() {
      // Redirect after the fade-out animation
      window.location.href = 'your_redirect_url.html'; // Change this to your desired URL
  });
}






// These are simple algorithms to modify data that don't need an individual function
let helpers = {
	// Pick a random question from the available ones
	pickRandomQ: function(obj,section){
		return Math.floor(Math.random() * obj.questions[section].length);		
	},
	// Gather a random question from every category
	getRandomQuestions: function(obj){
		let questions = [];
		let categories = Object.keys(obj.questions);
		categories.forEach((cat) => {
			let randomQ = this.pickRandomQ(obj,cat);
			let question = obj.questions[cat][randomQ];
			question.category = cat;
			questions.push(question);
		});
		return questions;
	},
	// Shuffle the answers so they don't appear in the same order
	shuffleAnswers: function(arr){
	    for (var i = arr.length - 1; i > 0; i--) {
	        var j = Math.floor(Math.random() * (i + 1));
	        var temp = arr[i];
	        arr[i] = arr[j];
	        arr[j] = temp;
	    }
	},
	// Update progress bar DOM element
	updateProgressBar: function(appState){
		$('.progress-bar').empty();
		appState.progress.progressBar.forEach((progInd => {
			$('.progress-bar').append(progInd);
		}))
	}
}

// Lets start the show
$(function(){

	// Kill any form refresh
	$('.answer-wrapper').on('submit', function(e){
		e.preventDefault();
	});

	// Storage for quiz app state
	let quizData;

	// Start quiz
	$('.start-quiz, .retry-btn').on('click', function(){
		quizData = makeQuiz();
		$fade(quizData);
	});

	// Select an answer
	$('.question-answer-wrapper').on('click', '.answer-btn', function(){
		selectAnswer($(this));
	})

	// Submit your answer to display feedback and advance question counter
	$('.question-answer-wrapper').on('click', '.submit-btn', function(e){
		submitAnswer(quizData);
	});

	// Submit your answer to display feedback and advance question counter
	$('.question-answer-wrapper').on('click', '.continue-btn', function(){
		$fade(quizData);
	});

	// Easter egg to chastize the user
	$('.quit-quiz').on('click', function(){
		killQuiz();
	})
})

